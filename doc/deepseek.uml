graph TB
    %% Client Layer
    A[External Client] -->|HTTP/REST| B[API Gateway]
    A -->|gRPC| B
    B -->|Auth| C[Authentication Service]
    
    %% API Layer
    B -->|Forward| D[Load Balancer]
    D --> E[VirtualMachinePool Service 1]
    D --> F[VirtualMachinePool Service 2]
    D --> G[VirtualMachinePool Service N]
    
    %% Core Services Layer
    subgraph Core Services
        E -->|Async Message| H[Service Discovery]
        F -->|Async Message| H
        G -->|Async Message| H
        
        E -->|Sync Call| I[VMManagement Service]
        F -->|Sync Call| I
        G -->|Sync Call| I
        
        I -->|Distributed Lock| J[Distributed Lock Manager]
        I -->|Resource Request| K[ResourceAllocator Cluster]
        I -->|Execution Command| L[LifecycleManager Cluster]
    end
    
    %% Infrastructure Layer
    K -->|Allocate| M[Resource Database]
    L -->|Execute| N[Hypervisor Cluster]
    I -->|Store State| O[State Database]
    E -->|Cache| P[Redis Cluster]
    
    %% Monitoring Layer
    Q[Monitoring System] -->|Metrics| R[Prometheus]
    Q -->|Logs| S[ELK Stack]
    Q -->|Traces| T[Jaeger]
    
    %% Connections
    E -->|Emit Metrics| Q
    I -->|Emit Metrics| Q
    K -->|Emit Metrics| Q
    L -->|Emit Metrics| Q
    
    %% External Systems
    U[Configuration Management] -->|Config Push| I
    V[Billing System] -->|Usage Data| I
    W[Notification Service] -->|Alerts| X[Ops Team]